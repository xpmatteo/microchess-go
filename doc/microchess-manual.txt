M I C R O C H E S S


    KIM Cassette Loading Instructions

1   Enter [RS] to reset KIM.
2   Enter [AD] 0 0 F 1 [DA] 0 0 to reset decimal flag.
3   Enter [AD] 1 7 F 9 [PA] C 1 to enter tape ID.
4   Enter [AD] 1 8 7 3 [GO] to begin read routine.
5   Start your cassette player.
6   When you see:    0000 D8 stop your cassette player.
7   Enter [RS] [AD] 1 8 7 3 [Go] to read block 2.
8   Start your cassette player.
9   When you see:   0000 D8  stop your cassette p1ayer.
10  Enter [RS] [Go] to start program execution.

    If you wish KIM to play a specific opening, enter the
    ID in addres 17F9 and load the opening data.   Enter
    [RS] before and after each tape load.


    Data for Openings

Microchess plays
white      black     Opening

A0         A1        Four Knights

A2         A3        French Defence

A4         A5        Ray Lopez

A6         A7        Queen's Indian

A8         A9        Guioce Piano


Remember to always press [RS] between each tape load.
Otherwise, data at 0100 and 0101 may be overwritten by
the stack.  Verify these locations against the program
listing if you have trouble executing the program.

A second copy of the two main programs can be found
after the openings.




M I C R O C H E S S





MICROCHESS was originally conceived as a program  which  would
play chess using only a minimum hobbyist microcomputer system.
The  program  designed will run on a KIM-1, 6502 based system,
using only 1.1 Kbytes of RAM.  Eliminatlon of some unnecessary
features would even allow an implementation in less  than  1K,


Although MICROCHESS does not play an expert level of chess, it
will  play  a reasonable game in most instances.  In addition,
It can provide a useful opponent  for  practising  checkmates,
learning openings, and sharpening general playing skills.


The  program  has been carefully designed to allow the average
user to expand  or  modify  the  basic  package  to  suit  the
requirements  of  his  particular  system conflguration, or to
experiment with his own ideas for improvement of  the  playing
strategy.


User   documentation  supplied  with  the  MICROCHESS  program
consists of a  Player's  Manual,  a  complete  source  program
listing,   and  a  Programmer's  Manual,  which  explains  the
operation  of  the  program  and  includes   suggestions   for
expansion and modifications,





© This copy of the  MICROCHESS  program   and  documentation  is
  provided  for the personal use and enjoyment of the purchaser.
  Reproduction  by  any  means  is  prohibited.   Use   of   the
  MICROCHESS  programs,  or any part thereof, for the purpose of
  promotion or  sale  of  microcomputer  hardware  or  software,
  without  the  express  written  permission  of  the  author is
  prohibited.  Address all communications to:


Micro-Ware Ltd.     
27 Firstbrooke Road,
Toronto Ontario,    
Canada,  M4E 2L2    



TABLE  OF  CONTENTS

		PLAYER'S MANUAL

		LOADING THE PROGRAMS                     1
		MICROCHESS NOTATION                      1
		MICROCHESS COMMAND KEYS                  2
		THE COMPUTER'S MOVE                      3
		TABLE OF PIECE CODES                     3
		ENTERING YOUR MOVE                       4
		SPECIAL MOVES                            5
		LEVEL OF PLAY                            6
		POSITION VERIFICATION                    6
		MEMORY LOCATIONS POR THE PIECES          7
		NOTES                                    8


		PROGRAMMER'S MANUAL

		INTRODUCTION                             1
		SOURCE LISTING                           1
		SUBROUTINES GNM AND JANUS                1
		OPERATION OF SUBROUTINE JANUS            2
		PROGRAM FUNCTION FOR EACH             
		VALUE OF STATE                           3
		STRATEGY OPERATION                       4
		OPENING PLAY                             5
		MODIFYING THE INPUT AND OUTPUT           6
		EXPANDED INPUT AND OUTPUT ROUTINES       7
		SPECIAL MOVES                            8
		STRATEGY IMPROVEMENTS                    8
		DATA FOR OPENINGS                       10
		EXPLANATION OF SYMBOLS                  11
		MICROCHESS  HEX LISTING                 12


		SOURCE LISTING                        

		MICROCHESS                               1
		SYMBOL TABLE AND CROSS REFERENCES       13
		BLOCK DATA                              15





MICROCHESS



PLAYER'S	MANUAL



         MICROCHESS was designed to play a game of chess using
the  KIM-1  microcomputer  system with no additional memory or
peripherals.  The human player's moves are entered on the self
contained keyboard and the computer's responses are flashed on
the LED display.  Slight program alterations will  permit  the
user  to  run  the  program using a teletype, CRT terminal, or
another 6502 based system, (see the  Programer's   Manual  for
details).   All  references in this manual assume that the KIM
keyboard and display are being used.


LOADING THE PROGRAMS

Since the KIM-1 memory  is  divided  into  two  non-contiguous
segments,  the  program  must  be loaded in two sections.  The
first section will contain the program and data for the  lower
1K  of  available memory between addresses 0000 and 03FFF. The
second  section  will  contain  the  program  segment  between
locations  1780  and 17E6.  In addition, short program loaders
may be used to enter  the  data  necessary  to  use  different
"canned  openings",  which  are  stored between 00C0 and 00DB.
Since sections  of  program  reside  in  page  one,  which  is
normally  reserved  for  the program stack, it is advisable to
reset the stack pointer using the [RS] key before  each  load.
In  addition,  it  is prudent to check locations 0100 and 0101
before executing the program to ensure that they have not been
inadvertently altered.


MICROCHESS NOTATION

In order  to  keep  memory  requirements  to  a  minimum,  (an
absolute   necessity   when   programming   chess  in  the  1K
environment of the KIM-1), it has  been  necessary  to  use  a
special  octal chess notation.  Each square on the chess board
is uniquely identified by a two digit octal number   as  shown
below.   The  first digit specifies the rank (0 to 7) from the
computer's  end of the board.  The second digit specifies  the
file  (0  to  7)  from the player's left.  Moves are specified
unliquely by the FR0M square  and  the  TO  square using  this
notation.


-2-


COMPUTER

 ---------------------------------------
| 00 | 01 | 02 | 03 | 04 | 05 | 06 | 07 |
|----+----+----+----+----+----+----+----+
| 10 | 11 | 12 | 13 | 14 | 15 | 16 | 17 |
|----+----+----+----+----+----+----+----+
| 20 | 21 | 22 | 23 | 24 | 25 | 26 | 27 |
|----+----+----+----+----+----+----+----+
| 30 | 31 | 32 | 33 | 34 | 35 | 36 | 37 |
|----+----+----+----+----+----+----+----+
| 40 | 41 | 42 | 43 | 44 | 45 | 46 | 47 |
|----+----+----+----+----+----+----+----+
| 50 | 51 | 52 | 53 | 54 | 55 | 56 | 57 |
|----+----+----+----+----+----+----+----+
| 60 | 61 | 62 | 63 | 64 | 65 | 66 | 67 |
|----+----+----+----+----+----+----+----+
| 70 | 71 | 72 | 73 | 74 | 75 | 76 | 77 |
 --------------------------------------- 

PLAYER

MICROCHESS COMMAND KEYS

The  following  keys  are used as commands white piaying chess
with the MICROCHESS program.

[GO]     This key is depressed immediately after  loading  the
         tape  in order to start the program execution,  or to
         restart the  program  after  a  temporary  exit.   No
         change  occurs  in the display after the [GO] key has
         been depressed.  After execution begins the  key  has
         no effect on the system at all.


[ST]     This  key is used to leave the MICROCHESS program and
         enter the  KIM monitor in order to examine or  change
         memory  contents  while  playing  a  game.   Under no
         circumstances should this key  be  pressed  when  the
         computer  is  contemplating its  move.  Only when the
         system is displaying a  move is   it  permissable  to
         to press the [ST] key.


[C]      This key CLEARS the internal chessboard and resets it
         to  begin another game.  The board is set up with the
         computer  playing  white.   CCCCCC  is  displayed  to
         indicate that the board has been reset.


-3-

[E]      This  key EXCHANGES the computer's men with your men.
         The actual position of the board  is  unchanged.   If
         [C]  is  pressed,  followed  immediately  by [E], the
         board will be  set  up  to  begin  a  game  with  the
         computer playing black.  By pressing [PC] followed by
         [E]  followed by [PC] . . .  the computer will play a
         game against itself, displaying the moves as it goes.
         EEEEEE is displayed immediately after the [E] key  is
         pressed to verify operation.


[F]      This key is used to move the piece on the FROM square
         to the TO square to register the player's move, or to
         move one of the computer's men if desired.


[PC]     This  key  instructs the computer to PLAY CHESS.  The
         computer analyses the current position and formulates
         its optimum move.  The display will darken and  flash
         until  the  move  has been decided.  When it relights
         the move is displayed.




THE COMPUTER'S MOVE

The computer moves are displayed in the format shown below:



[piece|FROM square|TO square]



[piece|  The piece which the computer is  indicating  that  it
         wishes  to  move  is  encoded  according to the table
         below:

 ----------------------------------------------------------------
| 0 - KING      | 4 - King Bishop  | B - K R Pawn | C - K B Pawn |
| 1 - Queen     | 5 - Queen Bishop | 9 - Q R Pawn | D - Q B Pawn |
| 2 - King Rook | 6 - King Knight  | A - K N Pawn | E - Q Pawn   |
| 3 - Queen Rook| 7 - Queen Knight | B - Q N Pawn | F - K Pawn   |
 ----------------------------------------------------------------

|FROM square|  The FROM and TO squares are indicated using the
         micronotation shown above.



For example the display [OF 13 33]  indicates  that  the  King
Pawn  is  to  be moved from King Pawn 2 to King Pawn 4.  (This
assumes that the computer is playing white.)


-4-

ENTERING YOUR MOVE

Your  moves ara described to the computer using the same octal
notation described above.  It is not necessary  to  enter  the
type  of piece being moved, just the FROM square and TO square
locations.

The computer verifies the input by indicating in the left  two
digits  the niece located on the FROM square.  The first digit
will be 0,1, or F,  0 indicates that the  piece  on  the  from
square  is  one  of  the computer's men.  1 indicates that the
piece is one of your men,  F indicates that there is no  piece
on the FROM square.

The  second  digit  indicates the type of piece located on the
FROM square using the same hexadecimal code shown above.


If you have made an error in entering your move at this  point
just continue to press the appropriate keys.  The numbers will
scroll from right to left until the correct move is displayed.

For  example,   if  you  punch   6 3 4 3   and see the display
[ 1F 63 43 ], the 1F indicates  that  the  FROM  square  (63),
contains  the  King Pawn and that you are preparing to move it
to  the square 43.

When you have entered and verified the move, depress  the  [F]
key  to  register  the  move on the internal chess board.  The
first two digits of the display  will  be  changed  to  FF  to
indicate  that  the  FROM square is now unoccupied.  If the TO
square had been occupied, the previous occupant will have been
captured automatically.

You may make as many moves in this manner as you wish,  moving
either your own men or the computer's.  No verification of the
legality  of  the  moves  is  carried  out.  Illegal moves are
accepted and executed as  easily  as  legal  moves,   so  care
shoull  be  taken  that  you  do  not  accidentally move in an
illegal manner.  Since the computer does not make a  point  of
warning  you if your king is in check, you must be careful not
to leave this situation after your move.   The  computer  will
usually  take  off your king on its subsequent move if this is
possible.


-5-

SPECIAL MOVES

CASTLING:       You may make a castling  move  by  making  two
         moves in succession in the normal manner.  First move
         the  king  to  its  new  square,  then move the rook.
         Remember  to  depress  [F]  after  each  move.    The
         computer  has  no  provision  for castling during the
         middle game or end game, but may  castle  during  the
         opening.   If  this occurs it will indicate a move of
         the king two squares over.   You  must  complete  the
         move  for  the  computer  by  moving the rook for it.
         Just  enter  the  appropriate  TO  and  FROM   square
         followed  by [F] to make the move, then, go ahead and
         make your own move.


EN PASSANT:     In order to capture en passant you must  break
         the  move  into two separate components.  First, move
         your pawn laterally to capture the  computer's  pawn.
         Then, move your pawn forward to its appropriate final
         square.  Do not forget to depress [F] after each move
         to  register  it  internally.  Note that the computer
         cannot  capture  en  passant  itself and   will   not
         recognize  the  danger of your en passant captures in
         considering its double pawn moves.




QUEENING PAWNS:  If you should succeed in pushing  a  pawn  to
         the eighth rank (rank 7 in micronotation), it will be
         necessary  for  you  to  manually set up the queen on
         that square.  Because of the internal  representation
         or the position it is possible only to have one Queen
         per  side at a  time.  Therefore, if you already have
         one, you will have  to  choose  a  rook,  bishop,  or
         knight instead.  To replace the pawn with a Queen the
         following steps should be carried out.

1)       Use  the [ST] key to exit from the MICBOCHESS program
         and return control to the KIM monitor.

2)       Find the pawn using  the  table  of  piece  locations
         below.   Confirm  by  its  position  that  it  is the
         correct one.  Remove it from the  board  by  entering
         the data 'CC', which indicates a captured piece.

3)       Enter  the  address of the queen (0061).  This memory
         location should now contain 'CC', assuming the  queen
         has been lost.


-6-



4)       Press [DA] and enter the new location for the  Queen,
         which is the square the pawn moved to. (e.g. 07)

5)       Press [PC] followed by [Go] to reenter the MICROCHESS
         prograrm.   Continue  in the  normal manner from this
         point.

         If the computer should push  a  pawn  to  the  eighth
         rank,  it  will  be  necessary for you to replace the
         pawn with a Queen, or the  highest  piece  available.
         Use  the   same  procedure  as above.  The computer's
         Queen should be stored at address 0051.





LEVEL OF PLAY
There are  several  sections  of  the  program  which  can  be
bypassed  in order to reduce the computer's response time in a
given  situation.   This  will  reduce  the  quality  of  play
accordingly.     The  strategy levels  and  data  changes  are
outlined below.

        ------------------------------------------------
       | LEVEL       | LOCATION | LOCATION | AVGF TIME  |
       |             |   02F2   |   018B   | PER MOVE   |
       |------------------------------------------------|
       | SUPER BLITZ |    00    |    FF    | 3 seconds  |
       | BLITZ       |    00    |    FB    | 10 seconds |
       | NORMAL      |    08    |    FB    | 100 second |
        ------------------------------------------------



POSITION VERIFICATION
Occassionally, while playing a game,  you  will  come  to  the
sudden  realization  that  the  computer is seeing a ditferent
board setup from the one you have.   This  results  from  your
misinterpretation  of  one  of its moves, from entering one of
your moves incorrectly, or from forgetting  to  press  (F]  to
register your move.

It  is  possible  in  this  situation  to  sneak a peek at the
location  of each piece as it is internally stored in order to
verify its location on the board.  To do this  Press  [ST]  to
exit  the  MICROCHESS program and enter the KIM monitor.  Then
look at the addresses  shown  below  to  determine  where  the 
computer  thinks  each  piece  is.   Afterwards, return to the
chess program by pressing [PC] followed by [GO].


-7-




MEMORY LOCATIONS FOR THE PIECES

 -------------------------------
| COMPUTER               YOUR   |
| PIECES                 PIECES |
|-------------------------------|
| 0050     King          0060   |
| 0051     Queen         0061   |
| 0052     King Rook     0062   |
| 0053     Queen Rook    0063   |
| 0054     King Bishop   0064   |
| 0055     Queen Bishop  0065   |
| 0056     King Knight   0066   |
| 0057     Queen Knight  0067   |
| 0u58     K R Pawn      0068   |
| 0059     Q R Pawn      0069   |
| 005A     K N Pawn      006A   |
| 005B     Q N Pawn      006B   |
| 005C     K B Pawn      006C   |
| 005D     Q B Pawn      006D   |
| 005E     Q Pawn        006E   |
| 005F     K Pawn        006F   |
 -------------------------------








IMPORTANT NOTE:
Never depress the [ST] key while the computer is  contemplating
its move.  Important parameters are stored in the  same area of
memory used by the KIM monitor programs,   Reentry after  these
locations  have  been  altered  will probably destroy the board
position.


-8-






NOTES

As  mentioned  above, there are three types of moves which the
current version  of  MICROCHESS  does  not  play.   These  are
castling, en passant pawn captures, and queening of pawns.  In
order  to make the game fair some players adopt one of the two
following strategies.  Recognizing that  the  computer  cannot
make  these  moves,  some  players  choose  not  to  make them
themselves, thus both players suffer  the  same  restrictions.
On  the  other  hand,  other  players have decided to help the
computer by watching for appropriate castling  or  en  passant
situations  and  making  the moves on the computer's behalf at
that time.  Of course, you may always play without  regard  to
the computer's disadvantage, allowing it to fend for itself as
best it can.




If  you  are  an  above  average player, you may find that the
MICROCHESS program is below your  level  of  play  and  hence,
always loses.  You can add to the challenge of the game in the
same way that you might against an inexperienced human player. 
Remove one or more of your pieces at the start of the game and
see if you can come back from a position of disadvantage,  The
easiest way to remove a piece is to move one of the computer's
men  to the   square of the piece you wish to remove, and then
move it back to its original square.












MICROCHESS



P R 0 G R A M M E R ' S    M A N U A L



The program can be divided into three basic functional  units.

I        Control and Input/Output.  This section comprises the
         initialization   routines,   the   input  and  output
         routines, and the main entry into the move generation
         and evaluation routines.

II       Move Generation and Data  Collection.   This  program
         group  generates the moves available to the computer,
         one at a time.  For each of  these  moves,  data  are
         collected regarding available continuation moves, the
         threats of possible reply moves, and the gain or loss
         from subsequent piece exchanges.

III      Strategic  Analysis.   The data collected by the move
         generation routines are analysed  by  a  mathematical
         algorithm  which  assigns  a  value to each available
         move.  The move with the highest assigned value  will
         be the move that the computer selects.




SOURCE LISTING

A  complete listing of the program is included in source form.
The average programmer should be able to use this document  as
a key to understanding the program's operation, and as a basis
for further modifications.  The complete cross reference table
is  included to assist in program relocation,  As a convention
in  the  listing,  variables  are  preceded  by  a  period  to
distinguish them from program labels, and external subroutines
are  preceded by an asterisk,  Comment lines are preceded by a
semicolon.



SUBROUTINES  GNM  AND  JANUS

The key to the operation or the MICROCHESS program lies in the
two subroutines GNM and JANUS.  GNM calculates  the  available
moves for one side with three nested loops:  NEWP, which loops
through  the  pieces  from  the pawns to the king;  NEX, which
loops through the four to eight directions through which  each
piece can move using the table MOVEX as pointed to by the move
direction  pointer  MOVEN;   and the individual loops for each
piece which select the appropriate directions and distances to
move.

<IMG alt="flow chart of JANUS" src="janus2x1.gif">


-3-

After  each  move  has  been calculated by GNM, the subroutine
JANUS is called.  JANUS uses the value of STATE  to  determine
which  portion  of the analysis the computer is working on and
directs it to the appropriate continuation routines.   As  can
be  seen  from  the simplifiad flow chart of JANUS' operation,
JANUS often alters the value of STATE and calls the subroutine
GNM  again.   This  series  of  recursive   subroutine   calls
calculates  approximately  20,000  moves  per  second-- over 2
million moves in a 100 second analysis.  Most of  these  moves
are  repetitions  generated  from  a  slightly different board
position.


PROGRAM FUNCTION FOR EACH VALUE OF .STATE

STATE   SET BY          FUNCTION

C       GO              Generate all available moves from  the
                        current  positton  and  analyse  as  a
                        benchmark with which  to  compare  the
                        real  moves,  which  are  generated by
                        STATE 4.

4       GO              Generate    all    available    moves,
                        evaluating  each  one  and assigning a
                        value to it as a  possible  selection,

8       JANUS           Having  made  one trial move, generate
                        the   possible   second   moves    for
                        analysis.

0       JANUS           Having  made  one trial move, generate
                        the possible.repiies for analys~s..

FF      JANUS           Since a  reply  move  was  a  capture,
                        reverse  the  board  and  evaluate the
                        exchange that could result,

FE      JANUS           Stage two of the  exchange  evaluation
                        started by STATE FF.

FD      JANUS           Stage    three    of    the   exchange
                        evaluation.

FC      JANUS           Last stage of the exchange evaitiation.

F9      CHKCHK          Look for a capture of the  king  which
                        signifies     that  the   move   being
                        calculated is illegal.


-4-

STRATEGY OPERATION

After each real available move is generated  and  the  various
counts  have  been  performed,  the  following  information is
available for decision making purposes.

MOB      Mobliity.  The total number of moves available for  a
         given side from a given position.  Each queen move is
         counted as two moves,

MAXC     Maximum  Capture.   The number of points,to be gained
         by cacturing the most valuable piece currently  under
         attack.

CC       Capture  Count.   The  total  points  of all opposing
         pieces under attack.

MAXP     Maximum  Capturable  Piece.   Identification  of  the
         opponent's piece under attack which is worth the most
         points.

PRIOR  COUNTS (.PMOB, .PMAXC,  PCC, .PMAXP) reflect the status
of the position as it exists for the computer before any  move
is made.  This is a benchmark, against which further moves are
to be compared.

CONTINUATION COUNTS (.WMOB, .WMAXC, .WCC, .WMAXP) are obtained
for  each  move  tested  to determine the potential of the new
position that would result if the move were made.

REPLY COUNTS (.BMOB, .BMAXC, .BCC, .BMAXP)  are  obtained  for
each  move  tested  to  determine  the potential danger of the
opponent's available replies.

EXCHANGE  COUNTS  (.WCAPO,  .WCAP1,  .WCAP2,  .BCAP0,  .BCAP1,
.BCAP2)  are  used  to  analyse  the  effect  of the potential
exchange combinations.  Each count reflects the maximum number 
of points capturable at each level of an exchange combination.
Capture chains are halted by pawn captures, king captures,  or
by reaching a limit of three captures per side.

In addition, information regarding the moving piece and its TO
and FROM squares can also be used by the STRATGY algorithm.

All  information available is combined by the algorithm in the
subprogram STRATGY to calculate a single strategic  value  for
the move under analysis.  The algorithm, a weighted sum of the
count information, is shown below:

VALUE = + 4.00 * WCAP0
        + 1.25 * WCAP1
        + 0.75 * (WMAXC + WCC)
        + 0.25 * (WMOB  + WCAP2)
        - 2.56 * BMAXC
        - 2.00 * BCC
        - 1.25 * BCAP1
        - 0.50 * BMAXC
        - 0.25 * (PMAXC + PCC + PMOB + BCAP0 + BCAP2 + BMOB)


-5-

VALUE  =  VALUE  +  02,	A position bonus if the move is to the
                        centre or out of the back rank.

VALUE = 00,  If the move is illegal because  the  king  is  in
                        check.

VALUE = FF,  If the move results in a checkmate.


The move with the highest value is selected by the computer as
the  best  move  available.   This  algorithm  can  easily  be
modified by changing  the  weights  assigned  to  the  various
parameters.  For example, the program can be made to play more
aggressively  by  increasing the importance or BMAXC and WCAP0
in the equation above.  On the other hand, it can be  made  to
play more defensively by increasing the importance or BMAXC in
the equation.

Note  that  the  algorithm  above  has not yet been optlmized.
Therefore, it may be possible  to  significantly  improve  the
play  of the program by enpirical testing to optimize the form
and weights used for the equation.

An alternative form of algorithm to the weighted average  type
above, which also works well, assigns a fixed number of points
to  the  occurrence  of certain conditions.   For example, the
condition WMOB &gt; PMOB may be considered to be worth  3  points
regardless   of  the  difference  in  value  between  the  two
variables.  Similarly, conditions which are unfavourable would
be assigned negative points.  This type  of  strategy  can  be
easily  implemented by keeping a running total or the value in
the accumulator and using CPX and CPY instructions to  control
branches  around  the  adddition and subtraction routines.  In
general, more memory  is  required  to  implement  an  equally
complex strategy using this type of algorithm, but in the long
run this strategy will be more flexible.




OPENING PLAY

The  MICROCHESS  program  is  designed  in such a way that the
opening can be played from memory, following established lines
of play for up to nine moves per side.  In order  to  conserve
memory, only one opening is actually stored in the computer at
a given time.  The opening is stored in locations 00C0 through
00DB.   By  storing  each of the openings provided on cassette
tape with a different ID for each, it is possible to load  the
desired  opening  before beginning play.  More openings can be
added to the repertoire by coding them  in  the  format  shown
below.

Users  with  expanded  memory can set up all the openings in a
set of tables, allowing the program to select the  appropriate
opening  as  long  as  its  opponent  is  following a standard
procedure.


-6-

The ability to load an opening by name and play  It  with  the
computer  also  provides  an  excellent  method  of rehearsing
openings for a chessplayer who is attempting to  memorize  the
standard plays.

Each  move  and  expected  reply  is  stored  in 3 bytes.  The
program first checks that the expected reply TO square is  the
same  as  the  one  in the stored opening.  If it matches, the
piece and the TO square for the  computer's  move  are  loaded
into  the  display  and  moved.   For  example,  the following
illustrates the GIUOCO PIANO Opening.  The computer is playing
white.

Address  Data     Move

00DB     CC       Expected display when oomputer is making
                  its first move.
00DA     0F       King pawn.
00D9     33       To KP4.
00D8     43       Expected reply P-KP4.

00D7     06       Knight.
00D6     22       To KB3.
00D5     52       Expected reply: N-QB3.

00D4     04       Bishop.
The last line of the opening  sequence  must  be  99,  or  any
impossible  position square, to cause the program to leave the
opening routine  and  enter  the  normal  strategy  evaluation
routines.


MODIFYING THE INPUT AND OUTPUT ROUTINES

In order to use the  MICROCHESS program on 6502 microprocessor
systems other than the KIM-1, the only modifications necessary
are  changes  to the input and output subroutine calls.  These
subroutines appear in the program listing as *OUT and  *GETKEY
at locations 0008, 000B, and 039F.

*OUT  is  a  subroutine  in the KIM ROM at location 1F1F which
displays,  in  hexadecimal  format,  the  contents  of  memory
locations  00FB,  00FA,  and  00F9 on the 6 digit LED display.
00FB contains the coded  piece  identifacation  and  locations
00FA  and  00F9  contain the FROM and TO squares respectively.
These three locations are also  used  to  display  CCCCCC  and
EEEEEE  as  verification  of  the  keyboard input.  At address
039F, *OUT is called by CKMATE at the end of the move analysis
to  flash  the  display.   This  call  is  not  necessary  for
operation  of  the  program and may be eliminated by replacing
the JMP instruction at that location with an  RTS  (60).   The
MICROCHESS program has been designed so that neither the X and
Y registers, nor the accumulator contents need be preserved by 
a replacement output subroutine.


-7-

*GETKEY  is  a  KIM  subroutine which returns the value of the
depressed key in  the  accumulator.   Hexadecimal  values  are
returned right justified (e.g. 0A).  The only non-hex key used
is  [PC]  which  returns  the value 14.  This key is used only
once, at location 0033, so is easy to replace with  any  other
value.   Once  again,  the  X  and  Y  registers  need  not be
preserved by a replacement input subroutine.




EXPANDED INPUT AND OUTPUT ROUTINES

Users with CRT or teletype  terminals  and  additional  memory
will  probably want to customize the input and output features
of the program.

A format which can be used for move entry and move display  is
shown  by  the  example: N(KN1) - KB3.  This format completely
expresses the move, and also provides a  check  value  in  the
piece  descriptor.   Translation  from	 this  notation  to the
internal  octal  FROM  and  TO  square  notation   is   easily
accomplished with a simpla table lookup program which	contains
the file descriptors and subtracts 01 from the rank value.

The board can be displayed by providing a routine which prints
a  layout  such as the one illustrated below.  Before printing
each square, the program could  search  the  piece  tables  to
deternime  if the square is occupied, and by which ciece.  The
table descriptor is then obtained from the same tables used by
the I/O routines above.  Users  with  graphic  terminals  will
want to set up even more elaborate board display routines.



----------------------------------------
|    |    |    |    |    |    |    |    |
| WR | WN | WB | WK | WQ | WB |    | WR |
|    |    |    |    |    |    |    |    |
|----+----+----+----+----+----+----+----+
|    |    |    |    |    |    |    |    |
| WP | WP | WP |    | WP | WP | WP | WP |
|    |    |    |    |    |    |    |    |
|----+----+----+----+----+----+----+----+
|    |    |    |    |    |    |    |    |
|    | ** |    | ** |    | WN |    | ** |
|    |    |    |    |    |    |    |    |
|----+----+----+----+----+----+----+----+
|    |    |    |    |    |    |    |    |





-8-

SPECIAL MOVES
Several  types  of  moves  are  not  included  in  the   basic
MICROCHESS  program  in  order reduce the memory requirements.
These moves, castling, en passant  canture,  and  queening  of
pawns,  can  be  added  by expanding and modifying some of the
subroutines which generate and execute moves,    GNM  must  be
modified  to  spot  the  occurrence of situations in which the
moves are available.  The actual  move  calculations  must  be
added  to CMOVS, and a flag to indicate the nature of the move
set to allow MOVE and UMOVE to properly interpret  them.   The
flag  could  use  the two  spare bits in  .SQUARE.  Additional
parameters wouid be required to indicate when castling, or  en
passant  moves  are legal during the game, because these moves
depend upon previous play for their  legality.   Expansion  of
the  piece  and  point tables would allow the program to keep.
track of more than one queen per side.



STRATEGY  IMPROVEMENTS
As you will soon discover when playing against the  MICRQCHESS
program,  it has a tendency to make ridiculous moves from time
to time.  These moves usually result from  unusual  positions,
which  point  out  deficiencies  in  the way the move value is
calculated.  A major problem in the analysis is that there  is
only  one  strategy  which is used for the opening, the middle
game,  and  the  end  game.   This  involves  a   considerable
compromise  of  three  different  types  of  play.  Users with
memory expansion may wish to write three algorithms which  can
be  switched  in  and  out  of  the analysis at various points
during the game.

Similarly, allowing more than 1K of memory enables the user to
add more specialized  evaluation  routines.   For  example,  a
separate  subroutine  could  be  used  to evaluate each of the
following situations from . both  an offensive  and  defensive
viewpoint,  enabling  a much more sophisticated level of play:
1- King in check.  A major fiaw in the current program  causes
the  computer  to  minimize  attacks by placing the opponent's
king in check, even at the expense of a minor  piece-  a  very
short  term  solution  to  the  problem!   2- En prise capture
availability for either  side.   3-  Pawn  development  value:
isolated  pawns,  passed  pawns,  doubled pawns, etc.  4- Xray
analysis: the value of pins, discovered attack  threats,  etc.
5-  Mating  strategies:  each of the major types of mates.  6-
Positional development: utilization of open files, control  of
the centre, king position, pawn chains, etc.


-9-

With the exception of the capture tree, the MICROCHESS program
analyses  in  full only one move for each side beyond the move
it will make.  It  is  possible  to  use  the  same  recursive
technique  used  by  TREE  to  carry  out a full analysis to a
further depth.  To do this would require a routine to  analyse
and evaluate each intermediate position arrived at.  Sequences
of  possibie positions with positive values for computer moves
and negative values for opponent's moves can be summed to give
the total long term value of each  currently  available  move.
In  order to be time efficient, this analysis can be performed
on a subset of the available continuations selected by a quick
static analysis.  In addition,  a  system  of  'tree  pruning'
should  be  implemented  to  prevent  long excursions down low
valued  branches.   Programmers  embarking  on  this  type  of
program should bear in mind that from an average position with
50  available  moves  per  side,  a  total  or  15.625 billion
sequences are generated in three moves per side.



As can be seen, MICROCHESS is only the beginning.  However, it
does demonstrate the capability  of  a  small  scale  hobbyist
microcomputer system to tackle the game of chess.  It is hoped
that  this  program will provide an inspiration and a stepping
stone that chess playing programmers  will  expand  and  build
upon.   Let  us know what you have done to improve the system.
We will attempt to publish or distribute some of  your  ideas.
It  is hoped that a tournament of chess playing microcomputers 
can be arranged at a future microcomputer gathering.  Expanded
and  modified  versions  of  MICROCHESS  will  then  have  the
opportunity  to  prove  their  playing  ability  against other
programs in the same memory. utilization class.






-10-

DATA FOR OPENINGS

The data below enables the coMputer to play the opening  specified
from memory. The data is in a block from 00C0 to 00DB. W specifies
that the computer will play white,  B specifies  that the computer
is black.

 ----------------------------------------------------------------
|    |  FRENCH   |  GIUOCO   |  RUY      |  QUEEN'S  |  FOUR     |
|ADDR|W DEFENCE B|W PIANO   B|W LOPEZ   B|W INDIAN  B|W KNIGHTS B|
|----+-----------+-----------+-----------+-----------+-----------|
| DB |CC       44|CC       44|CC       44|CC       43|CC       44|
| DA |0F P-K3  OF|OF P-K4  0F|0F P-K4  0F|OE P-Q4  06|0F P-K4  0F|
| D9 |33 P-K3  24|33 P-K4  34|33 P-K4  34|34 N-KB3 25|33 P-K4  34|
| D8 |53       43|43       55|43       55|52       42|43       55|
| D7 |0E P-Q4  0E|06 N-KB3 07|06 N-KB3 07|0D P-QB4 0F|06 N-KB3 07|
| D6 |43 P-Q4  33|22 N-QB3 22|22 N-QB3 22|35 P-K3  24|22 N-QB3 22|
| D5 |44       52|55       42|55       31|53       55|55       52|
| D4 |07 N-QB3 06|04 B-B4  04|04 B-N5  06|06 N-KB3 0B|07 N-B3  06|
| D3 |25 N-KB3 25|35 B-B4  32|46 N-B3  25|22 P-QN3 21|25 N-B3  25|
| D2 |52       36|45       52|52       75|56       56|52       31|
| D1 |05 B-N5  04|0D P-B3  06|00 O-O   06|0A P-KN3 05|04 B-N5  04|
| D0 |41 B-K2  14|25 N-B3  25|01 NxP   44|21 B-N2  11|46 B-N5  41|
| CF |63       34|52       43|33       43|66       66|36       75|
| CE |0F P-K5  06|0E P-Q4  0F|0E P-Q4  04|04 B-N2  04|00 O-O   00|
| CD |43 KN-Q2 13|34 PxP   43|34 B-K2  14|11 B-K2  14|01 O-O   06|
| CC |64       14|34       43|63       64|63       75|72       53|
| CB |05 BxB   01|0D PxP   04|01 Q-K2  06|00 O-O   00|0E P-Q3  0E|
| CA |63 QxB   14|34 B-N5  41|13 N-Q3  23|01 O-O   06|24 P-Q3  23|
| C9 |63       63|36       52|54       22|72       52|54       36|
| C8 |01 Q-Q2  00|07 N-B3  06|04 BxN   0B|07 N-B3  06|05 B-N5  04|
| C7 |14 O-O   06|25 NxKP  44|55 NPxB  22|25 N-K5  44|41 BxN   52|
| C6 |72       45|33       75|55       34|33       62|25       52|
| C5 |0C P-B4  0D|00 O-O   06|0E PxP   06|01 Q-B2  06|0B PxB   01|
| C4 |32 P-QB4 32|01 NxN   52|43 N-N2  11|15 NxN   52|25 Q-K2  14|
| C3 |45       55|25       52|66       52|25       52|63       74|
| C2 |06 N-B3  07|0B PxN   04|07 N-B3  00|01 QxN   0C|02 R-K1  07|
| C1 |22 N-QB3 22|25 BxP   52|25 O-O   06|25 P-KB4 35|03 N-Q1  03|
| C0 |99       99|99       99|99       99|99       99|99       99|
 ----------------------------------------------------------------

(This page was originaly in landscape format)





-11-

EXPLANATION OF SYMBOLS

ADDR	SYMBOL    EXPLANATION

0050	.BOARD  : LOCATION OF PIECES
0060	.BK     : OPPONENT'S PIECES
0070	.SETW   : INITIAL PIECE LOCATIONS
008F	.MOVEX  : TABLE OF MOVE DIRECTIONS
00A0	.POINTS : TABLE OF PIECE VALUES
00B0	.PIECE  : CURRENT PIECE UNDER ANALYSIS
00B1	.SQUARE : TO SQUARE OF .PIECE
00B2	.SP2    : STACK POINTER FOR STACK 2
00B3	.SP1    : STACK POINTER FOR STACK 1
00B4	.INCHEK : MOVE INTO CHECK FLAG
00B5	.STATE  : STATE OF ANALYSIS
00B6	.MOVEN  : MOVE TABLE POINTER
00DC	.OMOVE  : OPENING POINTER
00DC	.OPNING : OPENING MOVE TABLE
00DD	.WCAP0  : COMPUTER CAPTURE 0
00DE	.COUNT  : START OF COUNT TABLE
00DE	.BCAP2  : OPPONENT CAPTURE 2
00DF	.WCAP2  : COMPUTER CAPTURE 2
00EO	.BCAP1  : OPPONENT CAPTURE 1
00E1	,WCAP1  : COMPUTER CAPTURE 1
00E2	.BCAP0  : OPPONENT CAPTURE 0
00E3	.MOB    : MOBILITY
00E4	.MAXC   : MAXIMUM CAPTURE
00E5	.CC     : CAPTURE COUNT
00E6	.PCAP   : PIECE ID OF MAXC
00E3	.BMOB   : OPPONENT MOBILITY
00E4	.BMAXC  : OPPONENT MAXIMUM CAPTURE
00E5	.BCC    : OPPONENT CAPTURE COUNT
00E6	.BMAXP  : OPPONENT MAXP
00E8	.XMAXC  : CURRENT MAXIMUM CAPTURE
00EB	.WMOB   : COMPUTER MOBILITY
00EC	.WMAXC  : COMPUTER MAXIMUM CAPTURE
00ED	.WCC    : COMPUTER CAPTURE COUNT
00EE	.WMAXP  : COMPUTER MAXP
00EF	.PMOB   : PREVIOUS COMPUTER MOB
00F0	.PMAXC  : PREVIOUS COMPUTER MAXC
00F1	.PCC    : PREVIOUS COMPUTER CC
00E2	.PCP    : PREVIOUS COMPUTER MAXP
00E3	.OLDKY  : KEY INPUT TEMPORARY
00FB	.BESTP  : PIECE OF BEST MOVE FOUND
00FA	.BESTV  : VALUE OF BEST MOVE FOUND
00F9	.BESTM  : TO SQUARE OF BEST MOVE
00FB	.DIS1   : DISPLAY POINT 1
00FA	.DIS2   : DISPLAY POINT 2
00F9	.DIS3   : DISPLAY POINT 3



