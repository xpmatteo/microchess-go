# Test sequence: C -> 1434 (complete move e2-e4) -> 1424 (replace with e2-e3) -> Enter -> Q
# This tests changing your mind mid-entry by entering 8 digits total
# Command: C14341424\rQ
# Based on observed behavior from: printf 'C14341424\rQ' | make play-6502
#
# Expected behavior:
# - First 4 digits (1434): build move e2-e4, find piece 0E at 14, DIS = 0E 14 34
# - Digits 5-8 (1424): continue rotating, building NEW move e2-e3, DIS = 0E 14 24
# - Carriage return: executes the LAST complete 4-digit move (e2-e3), NOT the first one
# - Result: pawn moves from e2 (14) to e3 (24), NOT to e4 (34)

name: "Change Move Mid-Entry (8 digits)"
description: "User enters 1434 (e2-e4) then changes to 1424 (e2-e3) before pressing Enter"

steps:
  - commands: "C"
    should_continue: true
    expected_display: |-
      MicroChess (c) 1996-2005 Peter Jennings, www.benlo.com
       00 01 02 03 04 05 06 07
      -------------------------
      |WR|WN|WB|WK|WQ|WB|WN|WR|00
      |WP|WP|WP|WP|WP|WP|WP|WP|10
      |  |**|  |**|  |**|  |**|20
      |**|  |**|  |**|  |**|  |30
      |  |**|  |**|  |**|  |**|40
      |**|  |**|  |**|  |**|  |50
      |BP|BP|BP|BP|BP|BP|BP|BP|60
      |BR|BN|BB|BK|BQ|BB|BN|BR|70
      -------------------------
       00 01 02 03 04 05 06 07
      CC CC CC

  # First 4 digits: 1434 (e2-e4)
  # After 4th digit, piece found: 0E 14 34
  - commands: "1434"
    should_continue: true
    expected_display: |-
      MicroChess (c) 1996-2005 Peter Jennings, www.benlo.com
       00 01 02 03 04 05 06 07
      -------------------------
      |WR|WN|WB|WK|WQ|WB|WN|WR|00
      |WP|WP|WP|WP|WP|WP|WP|WP|10
      |  |**|  |**|  |**|  |**|20
      |**|  |**|  |**|  |**|  |30
      |  |**|  |**|  |**|  |**|40
      |**|  |**|  |**|  |**|  |50
      |BP|BP|BP|BP|BP|BP|BP|BP|60
      |BR|BN|BB|BK|BQ|BB|BN|BR|70
      -------------------------
       00 01 02 03 04 05 06 07
      0E 14 34

  # Digits 5-6: 14 (start of new move)
  # DIS1 reset to FF, digits rotate: FF 34 14
  - commands: "14"
    should_continue: true
    expected_display: |-
      MicroChess (c) 1996-2005 Peter Jennings, www.benlo.com
       00 01 02 03 04 05 06 07
      -------------------------
      |WR|WN|WB|WK|WQ|WB|WN|WR|00
      |WP|WP|WP|WP|WP|WP|WP|WP|10
      |  |**|  |**|  |**|  |**|20
      |**|  |**|  |**|  |**|  |30
      |  |**|  |**|  |**|  |**|40
      |**|  |**|  |**|  |**|  |50
      |BP|BP|BP|BP|BP|BP|BP|BP|60
      |BR|BN|BB|BK|BQ|BB|BN|BR|70
      -------------------------
       00 01 02 03 04 05 06 07
      FF 34 14

  # Digits 7-8: 24 (complete new move e2-e3)
  # After 8th digit (4th of current sequence), piece found: 0E 14 24
  - commands: "24"
    should_continue: true
    expected_display: |-
      MicroChess (c) 1996-2005 Peter Jennings, www.benlo.com
       00 01 02 03 04 05 06 07
      -------------------------
      |WR|WN|WB|WK|WQ|WB|WN|WR|00
      |WP|WP|WP|WP|WP|WP|WP|WP|10
      |  |**|  |**|  |**|  |**|20
      |**|  |**|  |**|  |**|  |30
      |  |**|  |**|  |**|  |**|40
      |**|  |**|  |**|  |**|  |50
      |BP|BP|BP|BP|BP|BP|BP|BP|60
      |BR|BN|BB|BK|BQ|BB|BN|BR|70
      -------------------------
       00 01 02 03 04 05 06 07
      0E 14 24

  # Carriage return: executes move 14->24 (e2-e3), NOT 14->34 (e2-e4)!
  # Pawn moves from rank 1 to rank 2 (one square forward)
  - commands: "\r"
    should_continue: true
    expected_display: |-
      MicroChess (c) 1996-2005 Peter Jennings, www.benlo.com
       00 01 02 03 04 05 06 07
      -------------------------
      |WR|WN|WB|WK|WQ|WB|WN|WR|00
      |WP|WP|WP|WP|**|WP|WP|WP|10
      |  |**|  |**|WP|**|  |**|20
      |**|  |**|  |**|  |**|  |30
      |  |**|  |**|  |**|  |**|40
      |**|  |**|  |**|  |**|  |50
      |BP|BP|BP|BP|BP|BP|BP|BP|60
      |BR|BN|BB|BK|BQ|BB|BN|BR|70
      -------------------------
       00 01 02 03 04 05 06 07
      FF 14 24

  - commands: "Q"
    should_continue: false
    expected_display: ""
